# SlideShot · Capture HTML Slides to PNG/PDF

[![Node](https://img.shields.io/badge/node-%3E=18.0-brightgreen)](https://nodejs.org)
[![Puppeteer](https://img.shields.io/badge/puppeteer-24.x-40B5A4)](https://pptr.dev/)
[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](./LICENSE)

[简体中文 | Chinese](./readme.md) · English

Precisely crop AI‑generated HTML slides into borderless, high‑resolution images (PNG/JPEG) and optionally combine them into a PDF. This tool is purpose‑built and optimized for the AI PPT pages on chat.z.ai: it waits for images and web fonts to load, supports 2x pixel density, allows Referer/cookies, and crops by the `.slide` container to match the page structure.

> Use case: Export each HTML slide generated by chat.z.ai AI PPT (e.g. `1.html ~ N.html`) to PNG/JPEG and optionally merge into a PDF for sharing, printing, or archiving.
>
> Disclaimer: This is a community project and is not affiliated with or endorsed by Zhipu/Chat Z (chat.z.ai).

---

## Preview

A sample output from this repository:

![sample](./1.png)

---

## Features

- Selector‑based cropping: Prefer the `.slide` element; fallback to `body` to avoid unexpected borders/distortion.
- High‑DPI export: Control pixel density via `--scale` (2x recommended).
- Asset readiness: Simulates scroll to trigger lazy loading; waits for images and web fonts to finish loading.
- Anti‑hotlink friendly: Support `--referer` header and `cookies.json` injection.
- Flexible formats: PNG/JPEG output; configurable JPEG quality.
- Multiple scenarios: Works with local `http://` servers and temporary `file://` (not recommended as default).

---

## Prerequisites

- Node.js 18 or newer (compatible with Puppeteer 24.x).
- Python 3 (optional, for `img2pdf` to merge images into a PDF).

---

## Quick Start

1) Install dependencies (first time):

```bash
npm install
```

2) Start a local static server in the folder containing `1.html ~ N.html` (e.g. port 8000):

```bash
python3 -m http.server 8000
```

3) Run the CLI (auto‑scans `*.html` in the current folder; 2x recommended：2560x1440):

```bash
npm run slideshot -- -s 2
```

Or run the local CLI directly:

```bash
node bin/slideshot.js -s 2
```

Output defaults to PNG with matching names: `1.png … N.png`.

---

## CLI Options

- `-b, --base <url>`: Base URL to open pages (default `http://localhost:8000/`; `file://` is supported).
- `-s, --scale <n>`: Pixel density (default 1; 2 recommended).
- `--referer <url>`: Set the Referer header (for hotlink protection).
- `--out-ext <ext>`: Output format `png|jpg|jpeg` (default `png`).
- `-q, --quality <0-100>`: JPEG quality (default 90; only for `jpg/jpeg`).
- `-p, --pattern <glob>`: Input pattern (default `*.html`; comma‑separated list allowed).
- `-c, --selector <css>`: Crop selector (default `.slide`; fallback to `body`).
- `--dry-run`: Print files and config without taking screenshots.

By default, the CLI scans `*.html`. You can use `--pattern` (e.g. `*.htm` or `1.html,2.html,4.html`) or pass filenames directly.

---

## CLI Help

```
SlideShot - HTML Slide Exporter

Usage:
  slideshot [options] [files...]

When no files are provided, *.html in the current folder will be scanned automatically.

Options:
  -b, --base <url>        Base URL (default http://localhost:8000/, accepts file://)
  -s, --scale <n>         Pixel density (default 1, recommend 2)
      --referer <url>     Set Referer header (handle hotlink protection)
      --out-ext <ext>     Output format png|jpg|jpeg (default png)
  -q, --quality <0-100>   JPEG quality (default 90; jpg/jpeg only)
  -p, --pattern <glob>    Input pattern (default *.html; comma-separated)
  -c, --selector <css>    Crop selector (default .slide; fallback body)
      --dry-run           Show files/config without taking screenshots
  -h, --help              Show help

Examples:
  slideshot -s 2                    # Scan *.html and export 2x PNG
  slideshot -s 2 --out-ext jpg -q 85
  slideshot -b file:// 1.html 2.html
  slideshot --referer https://example.com/
```

---

## Advanced

- Cookies injection: Put a `cookies.json` (array of standard Puppeteer cookie objects) in project root; CLI injects them before each page.
- Temporary `file://` mode:

```bash
npm run slideshot -- -b file:// 1.html 2.html
```

> Note: `file://` mode relaxes browser security; use only in trusted local environments.

---

## Merge into PDF (optional)

Use Python `img2pdf` to combine PNG/JPEG into a single PDF:

```bash
pip3 install img2pdf
python3 -m img2pdf 1.png 2.png 3.png 4.png -o slides_combined.pdf
```

Or with a sorted wildcard (mind the order):

```bash
python3 -m img2pdf $(printf "%s\n" ./*.png | sort) -o slides_combined.pdf
```

---

## FAQ

- Images not loaded or blank output? Use a local HTTP server; if hotlink protection exists, set `--referer`; also verify network and asset URLs.
- White borders in screenshots? Ensure your slide container uses the `.slide` class; fallback to `body` may include extra paddings.
- Missing Chinese or special glyphs? Install corresponding fonts on target OS; for Linux, try Noto Sans CJK.
- Need login to access assets? Provide `cookies.json` and retry.
- Very long slides or heavy lazy‑loading? The script scrolls and waits for images/fonts; if issues persist, adjust your HTML or timing settings.

---

## Output Notes

- Filenames: Based on input HTML with a new extension, e.g. `3.html → 3.png` or `3.jpg`.
- Cropping: Prefer `.slide` rectangle; fallback to `body` (may include margins).

---

## Roadmap

- [x] Auto‑discover `*.html` and sort naturally.
- [x] CLI options and basic dry‑run smoke test.
- [ ] Friendlier logs/progress bar.
- [ ] One‑shot PDF export on Node side.
- [ ] More templates and examples.

---

## Contributing

Issues and PRs are welcome:

- Include OS, Node version, sample HTML, and console logs when filing issues.
- Keep coding style consistent; update README/examples when changing behavior.

---

## License

MIT License — see [LICENSE](./LICENSE).

---

## Acknowledgements

- Zhipu AI (GLM series) for generating HTML slide content.
- Picui image hosting for sample images.

If this tool helps you, a star is appreciated!
